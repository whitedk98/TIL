# ì‹œìŠ¤í…œ ì´ìƒ íƒì§€ ë° Cryptojacking Malware ëŒ€ì‘ ì‹¤ìŠµ ì •ë¦¬

---

## 1. ê°œìš” (Overview)

ì‹¤ì œ í˜„ì—…ì—ì„œ ê²½í—˜í•œ ì‹œìŠ¤í…œ ì´ìƒ íƒì§€ ì‚¬ë¡€ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ë¹„ì •ìƒì ì¸ CPU ì ìœ  ë° ì•…ì„± í”„ë¡œì„¸ìŠ¤ í™•ì¸, ê·¸ë¦¬ê³  ê·¸ì— ë”°ë¥¸ ë³´ì•ˆ ì¡°ì¹˜ ì‚¬í•­ì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

ì´ ì‚¬ë¡€ì—ì„œëŠ” ì™¸ë¶€ì—ì„œ ì¹¨íˆ¬í•œ í›„ ë‚´ë¶€ ì‹œìŠ¤í…œì— í™•ì‚°ë˜ëŠ” **Cryptojacking malware**ë¥¼ íƒì§€í•˜ê³  ì œê±°í•˜ëŠ” ê³¼ì •ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## 2. ì´ìƒ ì§•í›„ íƒì§€ ë° ì´ˆê¸° ë¶„ì„

### â–¸ ì´ìƒ ì¦ìƒ

* ì‹œìŠ¤í…œì˜ CPU ì‚¬ìš©ëŸ‰ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ìŒ
* `top` ëª…ë ¹ì–´ë¡œ í™•ì¸í•œ ê²°ê³¼, `sh` í”„ë¡œì„¸ìŠ¤ê°€ CPUë¥¼ 199% ì‚¬ìš© ì¤‘ì´ë©°, ì¥ì‹œê°„ ì‹¤í–‰ë¨

```bash
top - 04:47:47 up 308 days, 22:06,  3 users,  load average: 4.01, 4.04, 4.08
Tasks: 312 total,   1 running, 311 sleeping,   0 stopped,   0 zombie
%Cpu(s): 50.3 us,  0.8 sy,  0.0 ni, 48.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  7910632 total,   192236 free,  5199368 used,  2519028 buff/cache
KiB Swap:  6713340 total,  6710772 free,     2568 used.  2032884 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 8440 {USER}     20   0 2445304   2.3g      8 S 199.0 30.4  11249:02 sh
11182 {USER}     20   0  801708 100664   9372 S   2.0  1.3   4030:43 gsd-color
```

### â–¸ ë¹„ì •ìƒ í”„ë¡œì„¸ìŠ¤ ì‹ë³„

```bash
ps -ef | grep 8440
{USER}    8440 1  0  2024 ?        2-19:10:43 /usr/bin/sshd
```

* í•´ë‹¹ ë°”ì´ë„ˆë¦¬ëŠ” gnome ê´€ë ¨ ì •ìƒ í”„ë¡œì„¸ìŠ¤ë¡œ ìœ„ì¥ë˜ì—ˆìœ¼ë‚˜, ìì› ì ìœ  ë° ì‹¤í–‰ ì‹œê°„ì´ ê³¼ë„í•˜ì—¬ ì•…ì„± ì½”ë“œë¡œ ì˜ì‹¬ë¨
* íŒŒì¼ í™•ì¸ ê²°ê³¼:

```bash
ls -l /usr/bin/sshd
ls: cannot access /usr/bin/sshd: No such file or directory
```

* í•´ë‹¹ ì‹¤í–‰íŒŒì¼ì€ ì•…ì„± í”„ë¡œì„¸ìŠ¤ê°€ ì„ì‹œë¡œ íŒŒì¼ì„ ìƒì„± í•´ ì‹¤í–‰í•œ ë’¤ ì‚­ì œí•œ ê²½ìš° í™•ì¸ë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.
* ì´ëŸ¬í•œ ê²½ìš° ë¹„ ì •ìƒ í”„ë¡œì„¸ìŠ¤ë¥¼ kill í–ˆì„ ë•Œ ë‹¤ì‹œ í”„ë¡œì„¸ìŠ¤ê°€ ì‚´ì•„ë‚˜ëŠ” ê²½ìš°ë¥¼ ì—­ì¶”ì  í•´ ê·¼ë³¸ Malwareë¥¼ ì œê±°í•´ì•¼ í•œë‹¤.



---

## 3. ì‚¬ìš©ì í™•ì¸ ë° ë‚´ë¶€ ì ‘ê·¼ ë¶„ì„

### â–¸ í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì í™•ì¸

```bash
w
who
```

```bash
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
dbsec    :0       :0               22Jul24 ?xdm?  12days  1:09  /usr/libexec/gnome-session-binary --session gnome-classic
dbsec    pts/0    10.120.130.11    04:47    0.00s  0.13s  0.03s w
dbsec    pts/2    :0               23Jul24 307days  0.16s  0.67s /usr/libexec/gnome-terminal-server
```

* ë‚´ë¶€ë§ IP `10.120.130.11`ì—ì„œì˜ SSH ì ‘ì† í™•ì¸

### â–¸ ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ ë° í™•ì‚° ê²½ë¡œ ë¶„ì„

* ì‹œìŠ¤í…œì€ **ë‚´ë¶€ë§**ì— ìœ„ì¹˜í•˜ë©°, ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ, ë‚´ë¶€ì—ì„œ ì™¸ë¶€ë¡œì˜ **outboundëŠ” í—ˆìš©**ëœ ìƒíƒœ
* **ì™¸ë¶€ë§ ì ‘ì†ì´ í—ˆìš©ëœ ë‚´ë¶€ ì¥ë¹„ë¡œë¶€í„° ì¹¨íˆ¬ í›„ lateral movementê°€ ë°œìƒí•œ ê²ƒìœ¼ë¡œ ì¶”ì •**

---

## 4. ê°ì—¼ ê²½ë¡œ ì°¨ë‹¨ ë° ë³´ì•ˆ ì¡°ì¹˜

### â–¸ ì·¨ì•½ ê³„ì • ë³´ì•ˆ ê°•í™”

* ì‹œìŠ¤í…œ ë‚´ ë“±ë¡ëœ ê³„ì • ì¤‘ ë¹„ë°€ë²ˆí˜¸ê°€ ì·¨ì•½í•œ ê³„ì •ì„ ëŒ€ìƒìœ¼ë¡œ ëª¨ë‘ ë³€ê²½

### â–¸ SSH ì¸ì¦ ê¸°ë°˜ ì°¨ë‹¨

* `.ssh/authorized_keys`, `.ssh/known_hosts` ë“±ì„ ì ê²€ ë° ê°±ì‹ í•˜ì—¬ ê³µê°œí‚¤ ê¸°ë°˜ ìë™ì ‘ì† ì°¨ë‹¨

---

## 5. ì•…ì„±ì½”ë“œ ìë™ ì‹¤í–‰ ì œê±° (ìŠ¤ì¼€ì¥´ë§ í™•ì¸)

### 1ï¸âƒ£ `crontab` ê¸°ë°˜ ìŠ¤ì¼€ì¥´ í™•ì¸

```bash
for user in $(cut -f1 -d: /etc/passwd); do echo "=== $user ==="; crontab -l -u $user 2>/dev/null; done
```

* ê²°ê³¼ ì˜ˆì‹œ:

```bash
=== {USER} ===
* * * * * /home/{USER}/updated/upd >/dev/null 2>&1
```

â†’ `crontab -e`ë¡œ í•´ë‹¹ í•­ëª© ì œê±°

### 2ï¸âƒ£ `systemd` ë° `service` ê¸°ë°˜ autorun ì œê±°

```bash
systemctl list-units --type=service | grep {malware name}
ls /etc/init.d | grep {malware name}
```

â†’ ë°œê²¬ ì‹œ disable ë° íŒŒì¼ ì œê±°

---

## 6. íŒŒì¼ ì†ì„± ë³´í˜¸ ìš°íšŒ ë° ì‚­ì œ

### â–¸ ì‚­ì œ ì‹¤íŒ¨ ë©”ì‹œì§€

```bash
rm: cannot remove 'updated/xxxx': Operation not permitted
```

### â–¸ `lsattr`ë¡œ í™•ì¸

```bash
lsattr *
----ia---------- config.json
...
```

### â–¸ ì†ì„± í•´ì œ ë° ì‚­ì œ

```bash
chattr -i -a *
rm -rf *
```

---

## 7. ì•…ì„±ì½”ë“œ ìœ„ì¥ í”„ë¡œì„¸ìŠ¤ ë° SSH íƒì§€

### â–¸ `/usr/bin/sshd` vs `/usr/sbin/sshd`

* `/usr/sbin/sshd`: ì •ìƒ ë°ëª¬ (root ì‹¤í–‰)
* `/usr/bin/sshd`: dbsec ì‚¬ìš©ìì— ì˜í•´ ìˆ˜ë™ ì‹¤í–‰, CPU 99%, PID 31137 â†’ **ì•…ì„± ì½”ë“œë¡œ ì˜ì‹¬**

```bash
ps -ef | grep sshd
dbsec    31137     1 99 05:09 ?        00:06:41 /usr/bin/sshd
```

### â–¸ `ssh-agent` ìœ„ì¥ íƒì§€

```bash
ls /usr/bin | grep ssh
```

* `ssh-agent`, `slogin` ë“±ì´ ì˜ˆìƒì¹˜ ëª»í•œ ì‚¬ìš©ì ì‹¤í–‰ ì—¬ë¶€ í™•ì¸ í•„ìš”

---

## 8. ë³´ì•ˆ ìœ„í˜‘ ì´í‰ ë° ê¶Œê³  ì‚¬í•­

* ë³¸ ì‚¬ë¡€ëŠ” ì™¸ë¶€ë§ê³¼ ì—°ê³„ëœ ì¥ë¹„ë¥¼ í†µí•´ ë‚´ë¶€ë§ ì „ì²´ë¡œ ì•…ì„±ì½”ë“œê°€ í™•ì‚°ëœ ì „í˜•ì ì¸ **Cryptojacking campaign** ì–‘ìƒ
* ë‹¨ì¼ ì‹œìŠ¤í…œ ë¿ ì•„ë‹ˆë¼ **ì£¼ë³€ ê°œë°œ ì„œë²„ë¡œ í™•ì‚°**ë˜ë©°, ë™ì¼í•œ ê³„ì • ì •ë³´ ì‚¬ìš©ìœ¼ë¡œ ì¸í•œ ë³´ì•ˆ ì·¨ì•½ì ì´ í•µì‹¬ í™•ì‚° ê²½ë¡œì˜€ìŒ
* `.ssh` ì¸ì¦ ì •ë³´ íƒˆì·¨ì™€ `crontab`, `systemd`, `attr` ë³´í˜¸ ê¸°ë²•ì´ ëª¨ë‘ í™œìš©ë˜ì—ˆìœ¼ë©°, `sshd` ë° `sh` í”„ë¡œì„¸ìŠ¤ê°€ ìœ„ì¥ë¨

### ğŸ” ê¶Œê³  ì‚¬í•­

* **ë¹„ë°€ë²ˆí˜¸ ì •ì±… ê°•í™”**: root ë° ì¼ë°˜ ì‚¬ìš©ì ëŒ€ìƒ ì „ìˆ˜ ë³€ê²½
* **ì¸ì¦ì„œ ê¸°ë°˜ SSH ì ‘ì†**: password ê¸°ë°˜ ì¸ì¦ ì œê±°
* **IP ê¸°ë°˜ ì ‘ê·¼ì œì–´**: ì™¸ë¶€ë§/ë‚´ë¶€ë§ êµ¬ë¶„ëœ ACL ì ìš©
* **ì •ê¸°ì  ìŠ¤ì¼€ì¥´ë§/íŒŒì¼ ì†ì„± ì ê²€**: `lsattr`, `chattr`, `cron`, `systemctl` ëª¨ë‹ˆí„°ë§

---

## History

ì‘ì„±ì¼: `2025-05-27`
